{
  "hash": "c746f5c705f5f5b9481558a53c7a98a1",
  "result": {
    "markdown": "---\ntitle: \"Text analytics and word cloud in R and ggplot2\"\nauthor: \"Nyamisi Peter\"\ndate: \"2023-02-15\"\ncategories: [visualization, code]\nimage: \"wordcloud.jpg\"\nbibliography: \"../blog.bib\"\n---\n\n\n# Introduction\n\n*wordcloud* is an image composed of words used in a particular text or subject, in which the size of each word indicates its frequency or importance. In this post, we are going to learn how to create worldcloud in R language [@r]. To generate wordcloud plot in R, we need either worcloud [@wordcloud] or wordcloud2 [@wordcloud2] packages. If these packages are not installed in your machine, you can simply download and install them from CRAN as;\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"wordcloud\")\ninstall.packages(\"wordcloud2\")\n```\n:::\n\n\nBefore we proceed, we need to load some packages, whose function we are going to use throughout this post. These packages are highlighted in the chunk below;\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(tidyverse)\nrequire(readxl)\nrequire(tm)           # for text mining\nrequire(SnowballC)    # for text stemming\nrequire(wordcloud)    # word-cloud generator\nrequire(RColorBrewer) # color palettes\nrequire(wordcloud2)\nrequire(ggalluvial)\n```\n:::\n\n\n# Data\nIn this post we are going to assess third year project student titles. The data has been organized and compiled in Excel spreadsheet. We can load this dataset into R session using  `read_excel()` function from **readxl** package [@readxl] and assign the loaded file as `student`. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nstudent = read_excel(\"student_2020-23.xlsx\")\n```\n:::\n\n\nIts a good practise to explore the internal structure of the loaded, though the str function is widely used for years, but @dplyr developed a `glimpse` function, which provide a nitty approach to look at the data and its associated variables;\n\n::: {.cell}\n\n```{.r .cell-code}\nstudent %>% \n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 163\nColumns: 5\n$ Name   <chr> \"Rashid Rahma A\", \"Muller Fransisca L\", \"Bitoye Mancef C\", \"Mma…\n$ gender <chr> \"F\", \"F\", \"F\", \"F\", \"F\", \"M\", \"M\", \"M\", \"F\", \"F\", \"F\", \"F\", \"F\"…\n$ field  <chr> \"microbiology\", \"aquaculture\", \"ecosystem\", \"aquaculture\", \"soc…\n$ Title  <chr> \"Assessing the prevalence and intensity of parasitic infections…\n$ year   <dbl> 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 202…\n```\n:::\n:::\n\nThe printed output of the interval structure indicates tha the file has five variables---name, gender, field, title and year. With exception of the year, which is numeric, the other variables are character. \n\n## tidy project titles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstudent.text = student$Title \n```\n:::\n\n\nThereafter, a corpus will be generated from the vector using the *Corpus()* function of **tm** package\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstudent.doc = tm::Corpus(VectorSource(student.text))\n```\n:::\n\n\n\nCleaning is an essential step to take before you generate your wordcloud. Indeed, for your analysis to bring useful insights, you may want to remove special characters, numbers or punctuation from your text. In addition, you should remove common stop words in order to produce meaningful results and avoid the most common frequent words such as “I” or “the” to appear in the word cloud. If you’re working with a corpus, there are several packages you can use to clean your text. The following lines of code show you how to do this using the tm package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstudent.doc.clean = student.doc %>% \n  tm_map(removeNumbers) %>% \n  tm_map(removePunctuation) %>% \n  tm_map(stripWhitespace) %>% \n  tm_map(content_transformer(tolower)) %>% \n  tm_map(removeWords, stopwords(kind = \"en\"))\n```\n:::\n\n\n### Create a document-term-matrix\n\nWhat you want to do as a next step is to have a dataframe containing each word in your first column and their frequency in the second column. This can be done by creating a document term matrix with the TermDocumentMatrix function from the tm package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstudent.matrix = TermDocumentMatrix(student.doc.clean) %>% \n  as.matrix()\n\nstudent.word = sort(rowSums(student.matrix), decreasing = TRUE)\n     \n student.word.df = data.frame(word = names(student.word), freq = student.word)\n```\n:::\n\n\n### Generate the word cloud\nThe wordcloud package is the most classic way to generate a word cloud. The following line of code shows you how to properly set the arguments. As an example, I chose to work with the student titles on their third year research project at SoAF.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234) # for reproducibility\n\nwordcloud(words = student.word.df$word, \n          freq = student.word.df$freq, \n          min.freq = 1,\n          random.order = FALSE, \n         max.words = 200,\n         # rot.per = 0.35,\n          colors = brewer.pal(8, \"Dark2\"),\n         scale = c(3.5,0.4))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nIt may happen that your word cloud crops certain words or simply doesn’t show them. If this happens, make sure to add the argument scale=c(3.5,0.25) and play around with the numbers to make the word cloud fit. Another common mistake with word clouds is to show too many words that have little frequency. If this is the case, make sure to adjust the minimum frequency argument (min.freq=…) in order to render your word cloud more meaningful.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234) # for reproducibility\n\nwordcloud(words = student.word.df$word, \n          freq = student.word.df$freq, \n          min.freq = 3,\n          random.order = FALSE, \n         # max.words = 1000,\n         # rot.per = 0.35,\n          colors = brewer.pal(8, \"Dark2\"), \n         scale = c(3.5,0.6))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nThe **wordcloud2** package is a bit more fun to use, allowing us to do some more advanced visualisations. For instance, you can choose your wordcloud to appear in a specific shape or even letter (see this vignette for a useful tutorial). As an example, I used the same corpus of student title and generated the two word clouds shown below. Cool, right?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwordcloud2(data = student.word.df, \n           size = 0.8, \n           color = \"random-dark\",\n           minSize = 3,\n           ellipticity = 2,\n           gridSize = 11)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"wordcloud2 html-widget html-fill-item\" id=\"htmlwidget-e841cfe017b85aa397a1\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-e841cfe017b85aa397a1\">{\"x\":{\"word\":[\"assessment\",\"kunduchi\",\"fish\",\"tilapia\",\"growth\",\"nile\",\"dar\",\"salaam\",\"assessing\",\"water\",\"performance\",\"effects\",\"catfish\",\"mangrove\",\"abundance\",\"different\",\"quality\",\"study\",\"using\",\"market\",\"fishing\",\"african\",\"rate\",\"beach\",\"river\",\"diversity\",\"sea\",\"along\",\"community\",\"effect\",\"cultured\",\"marine\",\"comparison\",\"meal\",\"production\",\"aquaculture\",\"determination\",\"tanks\",\"species\",\"niloticus\",\"seaweed\",\"influence\",\"comparative\",\"ferry\",\"fisheries\",\"feed\",\"survival\",\"coastal\",\"protein\",\"efficiency\",\"bagamoyo\",\"seagrass\",\"macrofauna\",\"fed\",\"sardine\",\"oreochromis\",\"chicken\",\"ponds\",\"system\",\"gariepinus\",\"beaches\",\"relation\",\"kinondoni\",\"tanzania\",\"forest\",\"use\",\"fingerlings\",\"case\",\"concentration\",\"nutrients\",\"commercial\",\"mlingotini\",\"moringa\",\"phytoplankton\",\"manure\",\"clarias\",\"levels\",\"organic\",\"mercury\",\"ras\",\"recirculating\",\"farmers\",\"local\",\"mbweni\",\"aquarium\",\"fishermen\",\"social\",\"change\",\"freshwater\",\"activities\",\"challenges\",\"scale\",\"small\",\"intertidal\",\"anchovies\",\"fry\",\"three\",\"landing\",\"application\",\"feeds\",\"factors\",\"effectiveness\",\"msimbazi\",\"juvenile\",\"catch\",\"district\",\"waste\",\"art\",\"leaves\",\"powder\",\"seed\",\"concrete\",\"plankton\",\"wastes\",\"artificial\",\"propagation\",\"zone\",\"distribution\",\"farming\",\"ocean\",\"pollution\",\"structure\",\"macroinvertebrate\",\"surface\",\"characteristics\",\"microplastic\",\"wetland\",\"drying\",\"contribution\",\"intensity\",\"municipal\",\"economic\",\"illegal\",\"facing\",\"women\",\"chain\",\"fishes\",\"value\",\"improving\",\"seagrasses\",\"acceptability\",\"consumer\",\"frying\",\"locally\",\"methods\",\"processed\",\"fresh\",\"salinity\",\"fried\",\"rates\",\"microbiological\",\"sites\",\"zones\",\"kijichi\",\"tegeta\",\"bukoba\",\"council\",\"chlorophylla\",\"relationship\",\"variation\",\"azolla\",\"raised\",\"feather\",\"source\",\"artemia\",\"comparing\",\"larvae\",\"live\",\"like\",\"product\",\"female\",\"maggots\",\"reproduction\",\"farms\",\"sources\",\"extent\",\"assemblages\",\"treatment\",\"cowdung\",\"productivity\",\"cow\",\"eggs\",\"investigation\",\"tuna\",\"fermented\",\"substratum\",\"food\",\"grown\",\"reproductive\",\"destruction\",\"functional\",\"habitat\",\"worms\",\"anthropogenic\",\"meiofauna\",\"ecosystem\",\"role\",\"potential\",\"benthic\",\"solid\",\"suspended\",\"total\",\"sediments\",\"spatial\",\"composition\",\"analysis\",\"loss\",\"postharvest\",\"waters\",\"light\",\"macro\",\"morogoro\",\"dynamics\",\"matter\",\"particulate\",\"markets\",\"tissues\",\"aspt\",\"bmwp\",\"biological\",\"management\",\"coast\",\"indian\",\"mackerel\",\"inorganic\",\"preferences\",\"shore\",\"pituitary\",\"sharptooth\",\"profitability\",\"microbial\",\"probiotics\",\"landed\",\"sediment\",\"traditional\",\"pond\",\"terebralia\",\"mapping\",\"region\",\"male\",\"sun\",\"business\",\"ornamental\",\"accumulation\",\"living\",\"income\",\"mixture\",\"rotifers\",\"infections\",\"parasitic\",\"prevalence\",\"selected\",\"wild\",\"area\",\"aloe\",\"behavior\",\"coat\",\"dissolved\",\"examining\",\"gel\",\"stress\",\"vera\",\"condition\",\"climate\",\"public\",\"understanding\",\"environment\",\"carbon\",\"found\",\"stocks\",\"aquacultural\",\"involved\",\"affects\",\"availability\",\"abudance\",\"cpue\",\"msasani\",\"sardines\",\"economy\",\"jarida\",\"langu\",\"science\",\"areas\",\"puna\",\"assessing \",\"boiling\",\"sundrying\",\"survivor\",\"types\",\"brackish\",\"cats\",\"catus\",\"felis\",\"raw\",\"boat\",\"building\",\"indigenous\",\"knowledge\",\"nonpelleted\",\"pelleted\",\"coco\",\"quantity\",\"trash\",\"trend\",\"type\",\"assesing\",\"conservation\",\"daressalaam\",\"environmental\",\"island\",\"sinda\",\"turtle\",\"auctioning\",\"systems\",\"wellbeing\",\"chemical\",\"demand\",\"oxygen\",\"additional\",\"fodder\",\"hydropnics\",\"increase\",\"concentrate\",\"diet\",\"pea\",\"substitute\",\"replacement\",\"snail\",\"tilapiacatfish\",\"effort\",\"per\",\"sangara\",\"trends\",\"unit\",\"investigating\",\" msimbazi\",\"gear\",\"seasonal\",\"usage\",\"alternative\",\"dietary\",\"partial\",\"bones\",\"made\",\"frozen\",\"post\",\" tilapia\",\"gill\",\"nets\",\"perch\",\"sample\",\"byproduct\",\"belly\",\"craft\",\"flower\",\"pots\",\"producing\",\"though\",\"fecundity\",\"impact\",\"neem\",\"common\",\"heavy\",\"metals\",\"used\",\"cause\",\"decreased\",\"lake\",\"victoria\",\"oil\",\"response\",\"spills\",\"addressing\",\"conflict\",\"determining\",\"reasons\",\"oleifera\",\"wastewater\",\"chloride\",\"polyvinyl\",\"eutrophication\",\"evaluation\",\"urine\",\"microplastics\",\"biodegraded\",\"biofertilizer\",\"fertilizing\",\"immuno\",\"stimulating\",\"black\",\"flies\",\"mass\",\"solders\",\"ginger\",\"kmno\",\"nacl\",\"substrate\",\"helmintheic\",\"infection\",\"clarius\",\"examine\",\"seminatural\",\"controlling\",\"pawpaw\",\"diets\",\"oleofera\",\"power\",\"root\",\"seeds\",\"baobab\",\"fishmeal\",\"junenile\",\"broillers\",\"background\",\"color\",\"dung\",\"housefly\",\"intestine\",\"leftovers\",\"produced\",\"substrates\",\"harak\",\"luthjanus\",\"pattern\",\"taxonomic\",\"wetlands\",\"structural\",\"erosion\",\"experiencing\",\"polychaete\",\"two\",\"impacts\",\"crabs\",\"feeding\",\"fiddler\",\"processing\",\"uca\",\"beachcast\",\"disturbance\",\"macroinvertebrates\",\"subjected\",\"university\",\"regeneration\",\"stages\",\"stands\",\"variability\",\"speciation\",\"tissue\",\"bongoyo\",\"mbudya\",\"medical\",\"reserves\",\"around\",\"awareness\",\"importance\",\"village\",\"enterprises\",\"smallscale\",\"socialeconomic\",\"artisanal\",\"baits\",\"status\",\"bioindicators\",\"road\",\"sewage\",\"bio\",\"indicator\",\"macrobenthic\",\"intensities\",\"bleaching\",\"invertebrate\",\"velocity\",\"epilithic\",\"epiphytic\",\"periphyton\",\"primary\",\"shredders\",\"streams\",\"adipose\",\"lates\",\"muscle\",\"parchased\",\"identifiction\",\"learning\",\"machine\",\"technology\",\"bwawani\",\"kibaha\",\"indices\",\"kizinga\",\"mzinga\",\"rivers\",\"urban\",\"ecological\",\"modelling\",\"stock\",\"filters\",\"framework\",\"policy\",\"regions\",\"unregulated\",\"unreported\",\"bmu\",\"roles\",\"chitosan\",\"coatings\",\"fillets\",\"nanochitosan\",\"refrigerated\",\"snapper\",\"consumer’s\",\"smoked\",\"biomass\",\"microlayer\",\"sub\",\"debris\",\"macroplastic\",\"bay\",\"gratilla\",\"oyster\",\"tripneustes\",\"assemblage\",\"habitats\",\"oysterbay\",\"urchin\",\"duck\",\"glands\",\"hormone\",\"inducing\",\"maturation\",\"muscovy\",\"ovaprim\",\"cost\",\"bioactive\",\"compounds\",\"farmed\",\"offal\",\"ingestion\",\"kigamboni\",\"bed\",\"coastline\",\"estuary\",\"plastic\",\"associates\",\"plants\",\"practices\",\"complexity\",\"culture\",\"avian\",\"estimation\",\"anesthesia\",\"dosage\",\"mode\",\"optimum\",\"giant\",\"micronutrients\",\"pallustris\",\"whelk\",\"gradient\",\"macrophyte\",\"zonation\",\"ecology\",\"hatchability\",\"latvae\",\"photoperiod\",\"regime\",\"high\",\"low\",\"periods\",\"fir\",\"formulated\",\"rearing\",\"bacteria\",\"coliform\",\"fecal\",\"sand\",\"silver\",\"associated\",\"costal\",\"investigate\",\"cleaner\",\"stocked\",\"together\",\"bufo\",\"cartifish\",\"gland\",\"regularis\",\"toad\",\"gastropod\",\"morphometric\",\"mtoni\",\"palustris\",\"variations\",\"nutrient\",\"removal\",\"salinities\",\"seaweedenteromorpha\",\"adult\",\"calf\",\"cattle\",\"fertilization\",\"aquatic\",\"catchment\",\"eco\",\"hydrological\",\"udzungwa\",\"consumption\",\"percapita\",\"animal\",\"based\",\"cockroach\",\"fly\",\"maggot\",\"pinnata\",\"plant\",\"density\",\"prawns\",\"stocking\",\"ground\",\"rack\",\"reducing\",\"safety\",\"site\",\"fishers\",\"livelihood\",\"crude\",\"weight\",\"licensing\",\"registration\",\"identification\",\"remote\",\"sensing\",\"phosphorus\",\"snappers\",\"smoking\",\"spoilage\",\"preference\",\"kawe\",\"litter\",\"standards\",\"trade\",\"traders\",\"households\",\"participating\",\"prohibiting\",\"standard\",\"catches\",\"corresponding\",\"data\",\"gisbased\",\"meadow\",\"approach\",\"bags\",\"biodegradable\",\"hessian\",\"pilot\",\"restoration\",\"activity\",\"cucumber\",\"holothuria\",\"induction\",\"scabra\",\"spawning\",\"tropical\",\"mji\",\"mwema\",\"stars\",\"micro\",\"microworms\",\"current\",\"shrimp\",\"development\",\"hindering\",\"villagebagamoyo\",\"dried\",\"juveniles\",\"leaf\",\"leucaena\",\"leucocephala\",\"mixed\",\"utilization\",\"bean\",\"soya\",\"cocktail\",\"fertilizers\",\"alpha\",\"concentrations\",\"egg\",\"immersion\",\"methyltestesterone\",\"reversal\",\"sex\",\"technique\",\"dasftkunduchi\",\"makongo\",\"tafiri\",\"aureus\",\"hirnorum\",\"hybridization\",\"inter\",\"specific\"],\"freq\":[63,38,35,31,28,27,24,24,22,22,19,16,14,13,12,12,11,11,11,10,10,10,10,10,10,9,9,9,9,9,8,8,8,8,8,8,8,8,7,7,7,7,6,6,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"fontFamily\":\"Segoe UI\",\"fontWeight\":\"bold\",\"color\":\"random-dark\",\"minSize\":3,\"weightFactor\":2.285714285714286,\"backgroundColor\":\"white\",\"gridSize\":11,\"minRotation\":-0.7853981633974483,\"maxRotation\":0.7853981633974483,\"shuffle\":true,\"rotateRatio\":0.4,\"shape\":\"circle\",\"ellipticity\":2,\"figBase64\":null,\"hover\":null},\"evals\":[],\"jsHooks\":{\"render\":[{\"code\":\"function(el,x){\\n                        console.log(123);\\n                        if(!iii){\\n                          window.location.reload();\\n                          iii = False;\\n\\n                        }\\n  }\",\"data\":null}]}}</script>\n```\n:::\n:::\n\n\nIn summary, R language provide myriad package for visualizing not only numeric data but also for textual information and summarize them in plots that are easily to understand. In the next post, we are going to use the approach to visualize textual information using alluvial plots\n\n## Consultated references\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\r\n<link href=\"../../site_libs/wordcloud2-0.0.1/wordcloud.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/wordcloud2-0.0.1/wordcloud2-all.js\"></script>\r\n<script src=\"../../site_libs/wordcloud2-0.0.1/hover.js\"></script>\r\n<script src=\"../../site_libs/wordcloud2-binding-0.2.1/wordcloud2.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}